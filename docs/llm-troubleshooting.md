# LLM æµ‹è¯•æ•…éšœæ’æŸ¥æŒ‡å—

## ğŸ” é—®é¢˜ï¼šæµ‹è¯• LLM æ—¶å‡ºé”™

### å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ

#### 1. æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨

**é”™è¯¯ä¿¡æ¯**ï¼š`æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨: http://192.168.0.13:11434/api/chat`

**å¯èƒ½åŸå› **ï¼š
- Ollama æœåŠ¡æœªåœ¨ 192.168.0.13 ä¸Šè¿è¡Œ
- ç«¯å£ 11434 è¢«é˜²ç«å¢™é˜»æ­¢
- IP åœ°å€è¾“å…¥é”™è¯¯

**è§£å†³æ–¹æ³•**ï¼š
1. åœ¨ 192.168.0.13 æœåŠ¡å™¨ä¸Šæ£€æŸ¥ Ollama æ˜¯å¦è¿è¡Œï¼š
   ```bash
   curl http://192.168.0.13:11434/api/tags
   ```

2. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®ï¼ˆåœ¨æœåŠ¡å™¨ä¸Šï¼‰ï¼š
   ```bash
   # Ubuntu/Debian
   sudo ufw allow 11434
   
   # æˆ–è€…
   sudo iptables -A INPUT -p tcp --dport 11434 -j ACCEPT
   ```

3. éªŒè¯ Ollama ç›‘å¬æ‰€æœ‰æ¥å£ï¼ˆä¸åªæ˜¯ localhostï¼‰ï¼š
   ```bash
   # æ£€æŸ¥ Ollama ç›‘å¬åœ°å€
   netstat -tuln | grep 11434
   
   # åº”è¯¥æ˜¾ç¤º 0.0.0.0:11434 æˆ– :::11434
   # å¦‚æœåªæ˜¾ç¤º 127.0.0.1:11434ï¼Œéœ€è¦é…ç½® Ollama
   ```

4. é…ç½® Ollama å…è®¸è¿œç¨‹è®¿é—®ï¼š
   ```bash
   # è®¾ç½®ç¯å¢ƒå˜é‡
   export OLLAMA_HOST=0.0.0.0:11434
   
   # é‡å¯ Ollama
   systemctl restart ollama
   ```

---

#### 2. è¯·æ±‚è¶…æ—¶

**é”™è¯¯ä¿¡æ¯**ï¼š`è¯·æ±‚è¶…æ—¶ï¼Œè¯·æ£€æŸ¥æœåŠ¡å™¨è¿æ¥`

**å¯èƒ½åŸå› **ï¼š
- ç½‘ç»œå»¶è¿Ÿè¿‡é«˜
- æ¨¡å‹åŠ è½½æ—¶é—´é•¿
- æœåŠ¡å™¨è´Ÿè½½é«˜

**è§£å†³æ–¹æ³•**ï¼š
1. æµ‹è¯•ç½‘ç»œå»¶è¿Ÿï¼š
   ```bash
   ping 192.168.0.13
   ```

2. ä½¿ç”¨è¾ƒå°çš„æ¨¡å‹ï¼ˆå¦‚ `qwen2:0.5b` è€Œä¸æ˜¯ `qwen2:7b`ï¼‰

3. å¢åŠ è¶…æ—¶æ—¶é—´ï¼ˆå½“å‰æ˜¯ 20 ç§’ï¼‰

---

#### 3. HTTP é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š`HTTP 404: Not Found` æˆ– `HTTP 500`

**å¯èƒ½åŸå› **ï¼š
- API è·¯å¾„é”™è¯¯
- æ¨¡å‹ä¸å­˜åœ¨
- Ollama ç‰ˆæœ¬ä¸å…¼å®¹

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥æ¨¡å‹æ˜¯å¦å·²ä¸‹è½½ï¼ˆåœ¨æœåŠ¡å™¨ä¸Šï¼‰ï¼š
   ```bash
   ollama list
   ```

2. å¦‚æœæ¨¡å‹ä¸å­˜åœ¨ï¼Œä¸‹è½½å®ƒï¼š
   ```bash
   ollama pull qwen2:0.5b
   ```

3. æµ‹è¯• API ç«¯ç‚¹ï¼š
   ```bash
   curl http://192.168.0.13:11434/api/tags
   ```

---

#### 4. æ¨¡å‹è¿”å›ç©ºå“åº”

**é”™è¯¯ä¿¡æ¯**ï¼š`æ¨¡å‹è¿”å›ç©ºå“åº”ï¼Œè¯·æ£€æŸ¥æ¨¡å‹æ˜¯å¦æ­£å¸¸å·¥ä½œ`

**å¯èƒ½åŸå› **ï¼š
- æ¨¡å‹æŸå
- å“åº”æ ¼å¼ä¸å…¼å®¹
- æ¨¡å‹ç”Ÿæˆå¤±è´¥

**è§£å†³æ–¹æ³•**ï¼š
1. åœ¨æœåŠ¡å™¨ä¸Šç›´æ¥æµ‹è¯•æ¨¡å‹ï¼š
   ```bash
   ollama run qwen2:0.5b "ä½ å¥½"
   ```

2. æ£€æŸ¥ Ollama ç‰ˆæœ¬ï¼š
   ```bash
   ollama --version
   ```
   å»ºè®®ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬

3. é‡æ–°ä¸‹è½½æ¨¡å‹ï¼š
   ```bash
   ollama rm qwen2:0.5b
   ollama pull qwen2:0.5b
   ```

---

## ğŸ› ï¸ è°ƒè¯•æ­¥éª¤

### æ­¥éª¤ 1ï¼šæ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š
```
http://192.168.0.13:11434/api/tags
```

**é¢„æœŸç»“æœ**ï¼š
```json
{
  "models": [
    {
      "name": "qwen2:0.5b",
      "modified_at": "...",
      "size": ...
    }
  ]
}
```

**å¦‚æœæ— æ³•è®¿é—®**ï¼š
- æ£€æŸ¥ IP åœ°å€æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦åœ¨åŒä¸€ç½‘ç»œ
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

---

### æ­¥éª¤ 2ï¼šæµ‹è¯• API è°ƒç”¨

åœ¨æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰è¿è¡Œï¼š

```javascript
// æµ‹è¯•è¿æ¥
fetch('http://192.168.0.13:11434/api/tags')
  .then(r => r.json())
  .then(data => console.log('å¯ç”¨æ¨¡å‹:', data))
  .catch(err => console.error('è¿æ¥å¤±è´¥:', err));

// æµ‹è¯•èŠå¤© API
fetch('http://192.168.0.13:11434/api/chat', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    model: 'qwen2:0.5b',
    messages: [
      { role: 'user', content: 'ä½ å¥½' }
    ],
    stream: false
  })
})
.then(r => r.json())
.then(data => console.log('å“åº”:', data))
.catch(err => console.error('è°ƒç”¨å¤±è´¥:', err));
```

---

### æ­¥éª¤ 3ï¼šæ£€æŸ¥ CORS è®¾ç½®

å¦‚æœæµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤º CORS é”™è¯¯ï¼š

**åœ¨æœåŠ¡å™¨ä¸Šé…ç½® Ollama å…è®¸è·¨åŸŸ**ï¼š

1. åˆ›å»º Nginx åå‘ä»£ç†ï¼ˆæ¨èï¼‰ï¼š
   ```nginx
   server {
       listen 11434;
       
       location / {
           proxy_pass http://localhost:11434;
           add_header 'Access-Control-Allow-Origin' '*';
           add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
           add_header 'Access-Control-Allow-Headers' 'Content-Type';
       }
   }
   ```

2. æˆ–ä½¿ç”¨ Ollama ç¯å¢ƒå˜é‡ï¼ˆå¦‚æœæ”¯æŒï¼‰ï¼š
   ```bash
   export OLLAMA_ORIGINS='*'
   systemctl restart ollama
   ```

---

### æ­¥éª¤ 4ï¼šæŸ¥çœ‹è¯¦ç»†é”™è¯¯

åœ¨æ¸¸æˆé…ç½®é¢æ¿æµ‹è¯•æ—¶ï¼Œæ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼š

```javascript
// é”™è¯¯ä¼šæ˜¾ç¤ºåœ¨æ§åˆ¶å°
// æ ¼å¼: "LLM test error: [è¯¦ç»†ä¿¡æ¯]"
```

---

## ğŸ“‹ æ£€æŸ¥æ¸…å•

æµ‹è¯•å‰ç¡®è®¤ï¼š

- [ ] Ollama åœ¨ 192.168.0.13 ä¸Šæ­£å¸¸è¿è¡Œ
- [ ] ç«¯å£ 11434 å¯ä»¥è®¿é—®
- [ ] æ¨¡å‹ `qwen2:0.5b` å·²ä¸‹è½½
- [ ] é˜²ç«å¢™å…è®¸ç«¯å£ 11434
- [ ] æµè§ˆå™¨å’ŒæœåŠ¡å™¨åœ¨åŒä¸€ç½‘ç»œ
- [ ] API URL æ­£ç¡®ï¼š`http://192.168.0.13:11434/api/chat`

---

## ğŸ”§ å¿«é€Ÿæµ‹è¯•å‘½ä»¤

### åœ¨æœåŠ¡å™¨ (192.168.0.13) ä¸Šï¼š

```bash
# 1. æ£€æŸ¥ Ollama è¿è¡ŒçŠ¶æ€
systemctl status ollama

# 2. æ£€æŸ¥ç›‘å¬ç«¯å£
netstat -tuln | grep 11434

# 3. æµ‹è¯•æœ¬åœ° API
curl http://localhost:11434/api/tags

# 4. åˆ—å‡ºæ¨¡å‹
ollama list

# 5. æµ‹è¯•æ¨¡å‹
ollama run qwen2:0.5b "ä½ å¥½"

# 6. æŸ¥çœ‹æ—¥å¿—
journalctl -u ollama -f
```

### åœ¨å®¢æˆ·ç«¯ï¼ˆä½ çš„ç”µè„‘ï¼‰ä¸Šï¼š

```bash
# 1. æµ‹è¯•ç½‘ç»œè¿æ¥
ping 192.168.0.13

# 2. æµ‹è¯•ç«¯å£
telnet 192.168.0.13 11434

# 3. æµ‹è¯• API
curl http://192.168.0.13:11434/api/tags

# 4. æµ‹è¯•èŠå¤©
curl -X POST http://192.168.0.13:11434/api/chat \
  -H "Content-Type: application/json" \
  -d '{
    "model": "qwen2:0.5b",
    "messages": [{"role": "user", "content": "ä½ å¥½"}],
    "stream": false
  }'
```

---

## ğŸ’¡ å¸¸è§è§£å†³æ–¹æ¡ˆæ€»ç»“

### é—®é¢˜ï¼šCannot connect to 192.168.0.13
**è§£å†³**ï¼šé…ç½® Ollama ç›‘å¬æ‰€æœ‰æ¥å£
```bash
export OLLAMA_HOST=0.0.0.0:11434
systemctl restart ollama
```

### é—®é¢˜ï¼šCORS error
**è§£å†³**ï¼šæ·»åŠ  Nginx åå‘ä»£ç†æˆ–è®¾ç½® OLLAMA_ORIGINS

### é—®é¢˜ï¼šModel not found
**è§£å†³**ï¼šä¸‹è½½æ¨¡å‹
```bash
ollama pull qwen2:0.5b
```

### é—®é¢˜ï¼šRequest timeout
**è§£å†³**ï¼šä½¿ç”¨æ›´å°çš„æ¨¡å‹æˆ–å¢åŠ è¶…æ—¶æ—¶é—´

---

## ğŸ“ è¿˜æ˜¯æ— æ³•è§£å†³ï¼Ÿ

1. è®°å½•å®Œæ•´çš„é”™è¯¯ä¿¡æ¯ï¼ˆåŒ…æ‹¬æµè§ˆå™¨æ§åˆ¶å°ï¼‰
2. è®°å½•æœåŠ¡å™¨ä¸Šçš„ Ollama æ—¥å¿—
3. æä¾›ç½‘ç»œé…ç½®ä¿¡æ¯
4. æä¾› Ollama ç‰ˆæœ¬å’Œæ¨¡å‹åˆ—è¡¨

---

## âœ… æˆåŠŸæ ‡å¿—

æµ‹è¯•æˆåŠŸæ—¶åº”è¯¥çœ‹åˆ°ï¼š
- çŠ¶æ€ï¼šğŸŸ¢ LLM å¯ç”¨
- å“åº”æ—¶é—´ï¼š< 2000ms
- è¿”å›å†…å®¹ï¼šæ¨¡å‹çš„å›å¤æ–‡æœ¬

ç¤ºä¾‹ï¼š
```
"ä½ å¥½ï¼æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ (è€—æ—¶: 856ms)"
```

