# ğŸŒ å¤–ç½‘è®¿é—®é…ç½® - 115.93.10.51

## ğŸ“‹ é…ç½®ä¿¡æ¯

- **å…¬ç½‘IP**: 115.93.10.51
- **å†…ç½‘æœåŠ¡å™¨**: 192.168.0.13
- **MeLo TTS ç«¯å£**: 7860
- **Ollama ç«¯å£**: 11434

## âœ… å·²å®Œæˆ

- âœ… æ£€æµ‹åˆ°å…¬ç½‘IP: 115.93.10.51
- âœ… ä¿®æ”¹åº”ç”¨é…ç½®æ–‡ä»¶ä½¿ç”¨å…¬ç½‘IP
  - `src/App.tsx` (MeLo TTSé…ç½®)
  - `src/config/chatConfig.ts` (Ollamaé…ç½®)

## ğŸš€ å¾…å®Œæˆé…ç½®

### 1. åœ¨ 0.13 æœåŠ¡å™¨ä¸Šé…ç½®æœåŠ¡

```bash
# SSH ç™»å½•åˆ°æœåŠ¡å™¨
ssh hlsystem@192.168.0.13

# è¿›å…¥é¡¹ç›®ç›®å½•
cd /home/jin/guozha_poker_game

# è¿è¡Œé…ç½®è„šæœ¬
chmod +x scripts/setup-ip-access.sh
sudo scripts/setup-ip-access.sh
```

**è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆï¼š**
- é…ç½® Ollama ç›‘å¬ 0.0.0.0:11434
- é…ç½®é˜²ç«å¢™å¼€æ”¾ 7860 å’Œ 11434 ç«¯å£
- å¯åŠ¨ Ollama æœåŠ¡

**æ‰‹åŠ¨å¯åŠ¨ MeLo TTSï¼ˆå¦‚æœæœªè¿è¡Œï¼‰ï¼š**
```bash
cd ~/melotts/MeloTTS
nohup python3 start-melo-tts-server.py > ~/melotts.log 2>&1 &
```

### 2. é…ç½®è·¯ç”±å™¨ç«¯å£è½¬å‘

ç™»å½•è·¯ç”±å™¨ç®¡ç†ç•Œé¢ï¼ˆé€šå¸¸æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼‰ï¼š
- http://192.168.0.1
- http://192.168.1.1
- http://192.168.31.1

æ‰¾åˆ°"ç«¯å£è½¬å‘"ã€"è™šæ‹ŸæœåŠ¡å™¨"æˆ–"NATè½¬å‘"è®¾ç½®ï¼Œæ·»åŠ ï¼š

| æœåŠ¡åç§° | å¤–éƒ¨ç«¯å£ | å†…éƒ¨IP | å†…éƒ¨ç«¯å£ | åè®® | è¯´æ˜ |
|---------|---------|--------|---------|------|------|
| MeLo-TTS | 7860 | 192.168.0.13 | 7860 | TCP | è¯­éŸ³åˆæˆæœåŠ¡ |
| Ollama | 11434 | 192.168.0.13 | 11434 | TCP | AIå¯¹è¯æœåŠ¡ |

## âœ… æµ‹è¯•è®¿é—®

### æµ‹è¯•å‘½ä»¤ï¼ˆä»ä»»ä½•åœ°æ–¹è¿è¡Œï¼‰

```bash
# 1. æµ‹è¯• MeLo TTS å¥åº·æ£€æŸ¥
curl http://115.93.10.51:7860/health

# æœŸæœ›è¾“å‡ºï¼š
# {"status":"ok","service":"Melo TTS","version":"1.0.0"}

# 2. æµ‹è¯• Ollama å¥åº·æ£€æŸ¥
curl http://115.93.10.51:11434/api/tags

# æœŸæœ›è¾“å‡ºï¼š
# {"models":[{"name":"qwen2:0.5b",...}]}

# 3. æµ‹è¯• TTS è¯­éŸ³åˆæˆ
curl -X POST http://115.93.10.51:7860/tts \
  -H "Content-Type: application/json" \
  -d '{"text": "å¤–ç½‘è®¿é—®æµ‹è¯•æˆåŠŸ", "lang": "ZH"}' \
  --output test-external.wav

# æ£€æŸ¥ç”Ÿæˆçš„æ–‡ä»¶
ls -lh test-external.wav

# 4. æµ‹è¯• Ollama å¯¹è¯
curl -X POST http://115.93.10.51:11434/api/chat \
  -H "Content-Type: application/json" \
  -d '{
    "model": "qwen2:0.5b",
    "messages": [
      {"role": "user", "content": "ä½ å¥½ï¼Œæµ‹è¯•ä¸€ä¸‹"}
    ],
    "stream": false
  }'
```

### åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•

1. **MeLo TTS API æ–‡æ¡£**
   - http://115.93.10.51:7860/docs

2. **å¥åº·æ£€æŸ¥**
   - http://115.93.10.51:7860/health
   - http://115.93.10.51:11434/api/tags

## ğŸ” æ•…éšœæ’æŸ¥

### å¦‚æœæ— æ³•è®¿é—®ï¼ŒæŒ‰é¡ºåºæ£€æŸ¥ï¼š

#### 1. æ£€æŸ¥ 0.13 æœåŠ¡å™¨æœ¬åœ°æœåŠ¡

```bash
# SSH åˆ° 192.168.0.13
ssh hlsystem@192.168.0.13

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status ollama
curl http://localhost:7860/health
curl http://localhost:11434/api/tags

# æ£€æŸ¥ç«¯å£ç›‘å¬
ss -tlnp | grep -E "7860|11434"

# åº”è¯¥çœ‹åˆ°ï¼š
# tcp   LISTEN 0.0.0.0:7860
# tcp   LISTEN 0.0.0.0:11434
```

#### 2. æ£€æŸ¥é˜²ç«å¢™

```bash
# æŸ¥çœ‹é˜²ç«å¢™è§„åˆ™
sudo ufw status numbered

# åº”è¯¥åŒ…å«ï¼š
# 7860/tcp    ALLOW IN    Anywhere
# 11434/tcp   ALLOW IN    Anywhere
```

#### 3. æ£€æŸ¥è·¯ç”±å™¨ç«¯å£è½¬å‘

- ç¡®è®¤è·¯ç”±å™¨ç«¯å£è½¬å‘è§„åˆ™å·²æ·»åŠ 
- ç¡®è®¤å†…ç½‘IPæ˜¯ 192.168.0.13
- ç¡®è®¤ç«¯å£å·æ­£ç¡®ï¼š7860 å’Œ 11434

#### 4. æµ‹è¯•å†…ç½‘è®¿é—®ï¼ˆä»å…¶ä»–å†…ç½‘è®¾å¤‡ï¼‰

```bash
curl http://192.168.0.13:7860/health
curl http://192.168.0.13:11434/api/tags
```

å¦‚æœå†…ç½‘å¯ä»¥è®¿é—®ï¼Œä½†å¤–ç½‘ä¸è¡Œï¼Œé—®é¢˜åœ¨è·¯ç”±å™¨ç«¯å£è½¬å‘ã€‚

#### 5. æµ‹è¯•å…¬ç½‘è®¿é—®ï¼ˆä»å¤–ç½‘è®¾å¤‡ï¼‰

```bash
curl http://115.93.10.51:7860/health
curl http://115.93.10.51:11434/api/tags
```

## ğŸ”’ å®‰å…¨å»ºè®®

### 1. æ·»åŠ é˜²ç«å¢™è§„åˆ™é™åˆ¶è®¿é—®ï¼ˆå¯é€‰ï¼‰

å¦‚æœåªæƒ³è®©ç‰¹å®šIPè®¿é—®ï¼š

```bash
# åˆ é™¤åŸæœ‰è§„åˆ™
sudo ufw delete allow 7860/tcp
sudo ufw delete allow 11434/tcp

# åªå…è®¸ç‰¹å®šIP
sudo ufw allow from ä½ çš„åŠå…¬å®¤IP to any port 7860 proto tcp
sudo ufw allow from ä½ çš„åŠå…¬å®¤IP to any port 11434 proto tcp
```

### 2. è€ƒè™‘ä½¿ç”¨ VPNï¼ˆæ¨èï¼‰

å¦‚æœæ˜¯å›¢é˜Ÿå†…éƒ¨ä½¿ç”¨ï¼Œå»ºè®®æ­å»º VPNï¼Œé¿å…æœåŠ¡ç›´æ¥æš´éœ²åœ¨å…¬ç½‘ã€‚

### 3. å®šæœŸæ›´æ–°æœåŠ¡

```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade

# æŸ¥çœ‹æ—¥å¿—
sudo tail -f /var/log/nginx/access.log
sudo journalctl -u ollama -f
```

## ğŸ“Š æœåŠ¡ç®¡ç†

### å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨ Ollama
sudo systemctl start ollama

# å¯åŠ¨ MeLo TTS
cd ~/melotts/MeloTTS
nohup python3 start-melo-tts-server.py > ~/melotts.log 2>&1 &
```

### åœæ­¢æœåŠ¡

```bash
# åœæ­¢ Ollama
sudo systemctl stop ollama

# åœæ­¢ MeLo TTS
pkill -f start-melo-tts-server
```

### æŸ¥çœ‹æ—¥å¿—

```bash
# Ollama æ—¥å¿—
sudo journalctl -u ollama -f

# MeLo TTS æ—¥å¿—
tail -f ~/melotts.log
```

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡
sudo systemctl status ollama
ps aux | grep start-melo-tts-server

# æŸ¥çœ‹ç«¯å£
ss -tlnp | grep -E "7860|11434"
```

## ğŸŒ å¤–ç½‘è®¿é—®åœ°å€æ€»ç»“

é…ç½®å®Œæˆåï¼Œä»ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨è¿™äº›åœ°å€ï¼š

- **MeLo TTS æœåŠ¡**: http://115.93.10.51:7860
- **MeLo TTS APIæ–‡æ¡£**: http://115.93.10.51:7860/docs
- **MeLo TTS å¥åº·æ£€æŸ¥**: http://115.93.10.51:7860/health
- **Ollama æœåŠ¡**: http://115.93.10.51:11434
- **Ollama æ¨¡å‹åˆ—è¡¨**: http://115.93.10.51:11434/api/tags

## ğŸ“± åº”ç”¨é…ç½®å·²æ›´æ–°

ä»¥ä¸‹æ–‡ä»¶å·²æ›´æ–°ä¸ºä½¿ç”¨å…¬ç½‘IPï¼š

1. **src/App.tsx** (ç¬¬98è¡Œ)
   ```typescript
   baseUrl: 'http://115.93.10.51:7860'
   ```

2. **src/config/chatConfig.ts** (ç¬¬89è¡Œ)
   ```typescript
   apiUrl: 'http://115.93.10.51:11434/api/chat'
   ```

**é‡å¯åº”ç”¨ç”Ÿæ•ˆï¼š**
```bash
# åœæ­¢å½“å‰åº”ç”¨ï¼ˆå¦‚æœåœ¨è¿è¡Œï¼‰
# æŒ‰ Ctrl+C

# é‡æ–°å¯åŠ¨
npm run dev
```

## âœ… é…ç½®å®Œæˆæ£€æŸ¥æ¸…å•

- [ ] è¿è¡Œ `sudo scripts/setup-ip-access.sh` é…ç½®æœåŠ¡å™¨
- [ ] MeLo TTS æœåŠ¡è¿è¡Œä¸­
- [ ] Ollama æœåŠ¡è¿è¡Œä¸­
- [ ] é˜²ç«å¢™å·²å¼€æ”¾ 7860 å’Œ 11434 ç«¯å£
- [ ] è·¯ç”±å™¨ç«¯å£è½¬å‘å·²é…ç½®
- [ ] æœ¬åœ°æµ‹è¯•é€šè¿‡ (localhost)
- [ ] å†…ç½‘æµ‹è¯•é€šè¿‡ (192.168.0.13)
- [ ] å¤–ç½‘æµ‹è¯•é€šè¿‡ (115.93.10.51)
- [ ] åº”ç”¨é…ç½®å·²æ›´æ–°
- [ ] åº”ç”¨é‡å¯å¹¶æµ‹è¯•

---

**é…ç½®æ—¶é—´**: 2025å¹´12æœˆ4æ—¥
**å…¬ç½‘IP**: 115.93.10.51
**çŠ¶æ€**: é…ç½®ä¸­ â³

é…ç½®å®Œæˆåï¼Œè®°å¾—å›æ¥æ›´æ–°çŠ¶æ€ä¸ºï¼šâœ… å·²å®Œæˆ

